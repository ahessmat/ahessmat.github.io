#### Introduction to Advanced CSRF & XSS Exploitation

This module is unique in that it supplies you a number of supporting malicious architecture upfront: an exfiltration server and an exploit server. The exfiltration server is intended to log inbound GET requests, which you can make use of in extracting various data from the exercise targets (e.g. cookies, web page contents, etc.). The exploit server is a staging area for malicious payloads that you craft.

Throughout the module, you use these two resources extensively - forcibly navigating victims to your exploit server and (as situations call for) routing responses back to your exfiltration server for observation. This section of the module is geared towards walking you through using the resources more generally with some easy XSS exercises.

#### CSRF Exploitation

This section is pretty beefy, being composed of 5 subsections all about **CSRF** and **CORS**. It starts by recapping what Cross-Site Request Forgery (CSRF) is, then denotes a number of defenses used to protect against it including **CSRF Tokens**, **HTTP Origin/Referer Headers**, **Same-Origin Policy & CORS**, and **SameSite Cookies**; the rest of the section is dedicated to learning how you might subvert those controls. Most of the exercises are phenomenal, but there are a handful of situations that logistically made things tricky.

More generally, the module inconsistently applies when you should suspend your sense of disbelief about how the victim receives your malicious payload. Sometimes - like in the "Introduction to Advanced CSRF & XSS Exploitation" section - you actually need to find an XSS vulnerability within the app and plant your payload; under these circumstances, the exercise(s) have an automated script that artificially has the victim user navigate to the page and trigger the payload. Other times however, you are permitted (or obligated) to handwaive that step and forcefully supply your malicious payload by way of the **Deliver Payload** functionality within the exploit server. This inconsistent application was frustrating, because if something's not working, you're unsure whether its a problem with the payload, your comprehension of the problem, the delivery channel, etc. This section in particular was made very frustrating by this.

The second issue comes with troubleshooting payloads; the Academy recommends you test your payloads with you own browser (navigating to the exploit yourself and seeing how it behaves) to determine what problems may exist before pushing the payload to the victim user. However, modern browsers have a number of additional controls in place to mitigate XSS/CSRF. For example, Firefox (the default browser in a number of distributions used by HTB users, including Kali and Parrot) has a "Privacy & Security" setting which blocks cookies from being transmitted by XHR requests by default with the "Standard" setting (this is configured by default in the Pwnbox). This means ocassionally the exploits *as written* won't work on your browser, but *will work* against the victim user. This discrepancy was *enormously* frustrating for me - I wasted a considerable amount of time trying to figure out a payload that would run against my own machine when said non-functioning payloads would work perfectly well against the adversary. 

#### XSS Exploitation

This section is the longest in the module and the last before the Skills Assessment. Assuming you came to understand the troubles described in the previous section, this one is pretty straightforward with some really creative applications of XSS. For example, they show how XSS can be used to enumerate hidden pages/content, chained together with other vulnerabilities like LFI & Command Injection, and even lead to SQL injection and internal network mapping. The exercises are great and the provided example payloads I was grateful to add to my collection.